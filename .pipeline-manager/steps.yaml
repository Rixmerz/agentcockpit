# Flow-Controlled MCP Pipeline - MVP
# Formato simplificado para parser b√°sico

# ============ CONFIGURACI√ìN ============
config:
  reset_policy: "timeout"
  timeout_minutes: 30
  force_sequential: false
  # Reset policy: "manual" | "timeout" | "per_session"
  # - manual: Solo reset con comando expl√≠cito
  # - timeout: Reset despu√©s de X minutos de inactividad
  # - per_session: Reset cada nueva sesi√≥n de Claude

  # Minutos de inactividad antes de reset (solo si reset_policy = "timeout")

  # Si true, el prompt injection incluye instrucci√≥n para completar todos los steps

# ============ STEPS ============


steps:
  - id: "complexity-check"
    order: 0
    name: "Complexity Gate"
    description: "Eval√∫a si la tarea requiere razonamiento estructurado"
    prompt_injection: |
      üîç STEP 0 - COMPLEXITY CHECK
      Antes de responder, eval√∫a:
      - ¬øEsta tarea tiene m√∫ltiples pasos interdependientes?
      - ¬øHay ambig√ºedad que requiere descomponer?
      - ¬øEl problema es complejo (>3 decisiones)?
      Si S√ç ‚Üí Usa sequential-thinking para estructurar tu razonamiento.
      Si NO ‚Üí Di "Tarea simple, procedo directamente" y contin√∫a.
    mcps_enabled:
      - "sequential-thinking"
    tools_blocked:
      - "Write"
      - "Edit"
    gate_type: "any"
    gate_tool: "mcp__sequential-thinking__sequentialthinking"
    gate_phrases:
      - "Tarea simple, procedo directamente"
      - "tarea simple"
      - "procedo directamente"

  - id: "library-context"
    order: 1
    name: "Library Context Gate"
    description: "Verifica si necesita documentaci√≥n de librer√≠as externas"
    prompt_injection: |
      üìö STEP 1 - LIBRARY CONTEXT
      ¬øEsta tarea involucra librer√≠as/frameworks externos?
      (React, Vue, Node, Python libs, APIs, etc.)
      Si S√ç ‚Üí Consulta Context7 para obtener docs actualizadas.
      Si NO ‚Üí Di "No requiere documentaci√≥n externa" y contin√∫a.
    mcps_enabled:
      - "Context7"
    tools_blocked:
      - "Write"
      - "Edit"
    gate_type: "any"
    gate_tool: "mcp__Context7__"
    gate_phrases:
      - "No requiere documentaci√≥n externa"
      - "no necesito documentaci√≥n"
      - "sin librer√≠as externas"

  - id: "implementation"
    order: 2
    name: "Implementation Gate"
    description: "Habilita escritura despu√©s de validar contexto"
    prompt_injection: |
      ‚úÖ CONTEXTO VALIDADO
      Steps completados. Puedes implementar.
      Recuerda: Lee antes de escribir (FFD).
    mcps_enabled:
      - "*"
    tools_blocked: []
    gate_type: "always"

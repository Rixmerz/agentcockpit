# DenoFresh Web Analyzer & Rebuild Pipeline v4.0
# Arquitectura hÃ­brida optimizada: 12 nodos (reducido de 17)

metadata:
  name: "DenoFresh Web Analyzer"
  description: "Pipeline hÃ­brida con subagents especializados. Analiza pÃ¡ginas web y las recrea con Deno Fresh."
  version: "4.0.0"
  type: "graph"
  author: "AgentCockpit"
  architecture: "hybrid-multi-agent"
  changelog: |
    v4.0.0 - Optimizaciones post-ejecuciÃ³n:
    - Fusionados: project-init + sections-creation + islands-creation â†’ project-build
    - Fusionados: seo-implementation + technical-files + accessibility-legal â†’ seo-technical
    - Agregado: InstrucciÃ³n para NO borrar .claude/pipeline/
    - Agregado: InstrucciÃ³n para usar search_tools del pipeline-manager
    - Agregado: ValidaciÃ³n de contenido del negocio (precios, moneda, nombres)
    - Agregado: Modo "sin preguntas" cuando usuario indica continuar
    - Reducido: 17 nodos â†’ 12 nodos
  agents_required:
    - "url-capture"
    - "web-analyzer"
    - "orchestrator"
    - "fresh-developer"
    - "creative-director"
    - "seo-specialist"
    - "ui-perfectionist"
  mcps_required:
    - "denofreshmcp"
    - "lighthouse"
    - "sequential-thinking"

# =============================================================================
# GLOBAL PROMPT INJECTION
# =============================================================================

global_prompt: |
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  REGLAS OBLIGATORIAS - DENO FRESH 2.2.0
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âŒ PROHIBIDO: deno task dev (DEPRECADO)
  âœ… OBLIGATORIO: deno task build && deno task start

  âŒ PROHIBIDO: Borrar o modificar .claude/pipeline/
  âœ… OBLIGATORIO: Preservar archivos de configuraciÃ³n del pipeline

  VERIFICACIONES:
  - AcentuaciÃ³n correcta (Ã¡, Ã©, Ã­, Ã³, Ãº, Ã±, Ã¼)
  - Contraste WCAG AA (4.5:1 mÃ­nimo)
  - Un solo H1 por pÃ¡gina

  BUSCAR MCPS:
  - Usar `search_tools(query)` del pipeline-manager para encontrar herramientas
  - Usar `refresh_tool_index()` si no encuentra resultados
  - NUNCA asumir que un MCP no existe sin buscarlo primero

  MODO SIN PREGUNTAS:
  - Si el usuario indica "continÃºa", "no te detengas", "procede" â†’ NO hacer preguntas FFD
  - Tomar decisiones razonables y avanzar
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# =============================================================================
# NODES - 12 nodos optimizados (antes 17)
# =============================================================================

nodes:
  # ---------------------------------------------------------------------------
  # FASE 1: CAPTURA Y ANÃLISIS
  # ---------------------------------------------------------------------------

  - id: "url-capture"
    name: "Captura de URL"
    is_start: true
    model: haiku
    max_visits: 5
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Capturar informaciÃ³n inicial del usuario para anÃ¡lisis web
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `url-capture`**

      INFORMACIÃ“N A RECOPILAR:
      1. URL completa de la pÃ¡gina (https://...)
      2. Ruta donde crear el proyecto Fresh
      3. Idioma del sitio (es/en)
      4. PaÃ­s/regiÃ³n (para moneda y legal)
      5. Â¿PropÃ³sito? (copia exacta o versiÃ³n mejorada)
      6. Â¿Contenido a excluir?

      SEÃ‘AL DE COMPLETADO: "url capturada"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: "web-analysis"
    name: "AnÃ¡lisis Web Completo"
    model: sonnet
    max_visits: 5
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Analizar pÃ¡gina web original exhaustivamente
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `web-analyzer`**

      BUSCAR MCP LIGHTHOUSE:
      - Ejecutar: search_tools("lighthouse audit")
      - Si no encuentra: refresh_tool_index() y reintentar
      - Usar: execute_mcp_tool("lighthouse", "run_audit", {url: "..."})

      EJECUTAR EN ORDEN:

      1. WEBFETCH - Extraer:
         â–¡ Estructura de secciones
         â–¡ Contenido textual (tÃ­tulos, CTAs, pÃ¡rrafos)
         â–¡ Meta tags y SEO actual
         â–¡ Paleta de colores inferida
         â–¡ Keywords para imÃ¡genes Pexels

      2. DATOS DEL NEGOCIO - Extraer EXACTAMENTE:
         â–¡ Precios con moneda original (ej: $32.000 CLP, no convertir)
         â–¡ Nombres de productos exactos
         â–¡ Descripciones de productos
         â–¡ Testimonios reales
         â–¡ Datos de contacto

      3. LIGHTHOUSE ORIGINAL - Documentar scores baseline

      SEÃ‘AL DE COMPLETADO: "anÃ¡lisis completado"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 2: PLANIFICACIÃ“N ESTRATÃ‰GICA
  # ---------------------------------------------------------------------------

  - id: "strategic-planning"
    name: "PlanificaciÃ³n EstratÃ©gica"
    model: opus
    max_visits: 3
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Crear plan de ejecuciÃ³n DEFINITIVO basado en el anÃ¡lisis
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `orchestrator`**

      El subagente debe usar sequential-thinking para:
      - Sintetizar todo el anÃ¡lisis
      - Tomar decisiones estratÃ©gicas
      - Crear plan sin ambigÃ¼edades

      EL PLAN DEBE INCLUIR (todo especÃ­fico):
      1. SECCIONES: Nombre, variante Fresh, contenido exacto
      2. ISLANDS: CuÃ¡les y configuraciÃ³n
      3. IMÃGENES: Query Pexels, orientaciÃ³n, tamaÃ±o
      4. SEO: Title exacto, description exacta, schemas
      5. COLORES: Paleta hex completa
      6. OBJETIVOS: Scores Lighthouse target

      âš ï¸ CRÃTICO - PRESERVAR DATOS DEL NEGOCIO:
      - Precios en moneda ORIGINAL (no convertir)
      - Nombres de productos EXACTOS del sitio original
      - Testimonios REALES (no inventar)

      SEÃ‘AL DE COMPLETADO: "sÃ­ntesis completada"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 3: CONSTRUCCIÃ“N COMPLETA (FUSIONADO)
  # ---------------------------------------------------------------------------

  - id: "project-build"
    name: "Construir Proyecto Completo"
    model: sonnet
    max_visits: 25
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Construir proyecto Fresh completo (init + secciones + islands + imÃ¡genes)
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `fresh-developer`**

      âš ï¸ CRÃTICO: NO borrar ni modificar .claude/pipeline/

      EJECUTAR EN ORDEN:

      1. INICIALIZAR PROYECTO:
         - fresh_init_project(project_path="[ruta del plan]")
         - Verificar que .claude/pipeline/ sigue intacto

      2. CREAR SECCIONES (segÃºn plan):
         - Header, Hero, SocialProof, ProductGrid, Ingredients, Testimonials, Footer
         - Usar contenido EXACTO del plan (precios originales, nombres exactos)
         - Verificar acentuaciÃ³n (Ã¡, Ã©, Ã­, Ã³, Ãº, Ã±)

      3. CREAR ISLANDS:
         - Islands del plan + obligatorios: MobileMenu, ScrollToTop, CookieConsent
         - fresh_add_island() para cada uno

      4. DESCARGAR IMÃGENES:
         - Verificar API: pexels_api_status()
         - pexels_search_and_download() para cada imagen del plan
         - Guardar crÃ©ditos en CREDITS.md

      5. VERIFICAR BUILD:
         - deno task build (debe compilar sin errores)

      RECORDAR:
      âŒ NUNCA usar: deno task dev
      âœ… SIEMPRE usar: deno task build && deno task start

      SEÃ‘AL DE COMPLETADO: "proyecto construido"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 4: DIRECCIÃ“N CREATIVA
  # ---------------------------------------------------------------------------

  - id: "creative-direction"
    name: "DirecciÃ³n Creativa"
    model: opus
    max_visits: 5
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Transformar diseÃ±o genÃ©rico en experiencia visual Ãºnica
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `creative-director`**

      CONTEXTO: El sitio tiene estructura y contenido base. Elevar la
      experiencia visual para que NO sea genÃ©rico.

      PROCESO:
      1. ANÃLISIS DE MARCA - Emociones target, personalidad visual
      2. DIRECCIÃ“N VISUAL - Paleta Ãºnica, tipografÃ­a, espaciado
      3. APLICAR CREATIVIDAD - Hero memorable, micro-interacciones
      4. CONSISTENCIA - Todo el sitio respira la misma identidad

      âš ï¸ NO MODIFICAR:
      - Precios (mantener moneda original)
      - Nombres de productos
      - Datos del negocio

      RESTRICCIONES: Mantener contraste WCAG AA (4.5:1)

      SEÃ‘AL DE COMPLETADO: "direcciÃ³n creativa aplicada"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 5: UI REVIEW (con loop)
  # ---------------------------------------------------------------------------

  - id: "ui-review"
    name: "Review UI/UX"
    model: sonnet
    max_visits: 10
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Revisar calidad visual con ojo crÃ­tico experto
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `ui-perfectionist`**

      REVISAR:
      â–¡ Espaciado y ritmo visual
      â–¡ TipografÃ­a y jerarquÃ­a
      â–¡ Colores y contraste
      â–¡ Componentes y CTAs
      â–¡ Responsive/mobile
      â–¡ Microinteracciones
      â–¡ AcentuaciÃ³n correcta en textos

      CRITERIO: "Â¿ImpresionarÃ­a a un cliente exigente?"

      FORMATO:
      - ğŸ”´ CrÃ­tico: debe corregirse
      - ğŸŸ¡ Importante: deberÃ­a corregirse
      - ğŸŸ¢ Menor: nice to have

      SEÃ‘ALES:
      - Si hay crÃ­ticos â†’ "ui requiere mejoras"
      - Si todo ok â†’ "ui review aprobado"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: "ui-fixes"
    name: "Correcciones UI"
    model: sonnet
    max_visits: 15
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Aplicar todas las correcciones de UI identificadas
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `ui-perfectionist`**

      ORDEN DE CORRECCIÃ“N:
      1. Issues ğŸ”´ CrÃ­ticos PRIMERO
      2. Issues ğŸŸ¡ Importantes
      3. Issues ğŸŸ¢ Menores si hay tiempo

      Para cada correcciÃ³n:
      - Editar archivo especÃ­fico
      - Verificar que el cambio se aplicÃ³

      SEÃ‘AL DE COMPLETADO: "correcciones ui aplicadas"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 6: SEO Y TÃ‰CNICOS (FUSIONADO)
  # ---------------------------------------------------------------------------

  - id: "seo-technical"
    name: "SEO, TÃ©cnicos y Legal"
    model: sonnet
    max_visits: 20
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Implementar SEO, archivos tÃ©cnicos, accesibilidad y legal
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `seo-specialist`**

      BUSCAR HERRAMIENTAS MCP:
      - Usar search_tools() del pipeline-manager
      - fresh_generate_sitemap, fresh_generate_robots, fresh_add_schema

      1. SEO TÃ‰CNICO:
         â–¡ Meta tags (title, description, canonical)
         â–¡ Open Graph completo
         â–¡ Twitter Cards
         â–¡ Schema.org (JSON-LD): Organization, Product, FAQPage
         â–¡ sitemap.xml
         â–¡ robots.txt
         â–¡ H1 Ãºnico, jerarquÃ­a correcta
         â–¡ Alt text en imÃ¡genes

      2. ARCHIVOS TÃ‰CNICOS:
         â–¡ routes/_404.tsx - PÃ¡gina 404 personalizada
         â–¡ routes/_500.tsx - PÃ¡gina de error
         â–¡ Favicon mÃºltiples tamaÃ±os
         â–¡ manifest.json (PWA)

      3. ACCESIBILIDAD (WCAG 2.1 AA):
         â–¡ Contraste verificado
         â–¡ Labels en inputs
         â–¡ Focus visible
         â–¡ Skip link
         â–¡ ARIA donde necesario

      4. LEGAL:
         â–¡ /privacy - PolÃ­tica de Privacidad (segÃºn paÃ­s)
         â–¡ /cookies - PolÃ­tica de Cookies
         â–¡ Cookie consent funcional
         â–¡ Links en footer

      SEÃ‘AL DE COMPLETADO: "seo y tÃ©cnicos listos"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 7: AUDITORÃA (con loop)
  # ---------------------------------------------------------------------------

  - id: "lighthouse-audit"
    name: "AuditorÃ­a Lighthouse"
    model: sonnet
    max_visits: 10
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Ejecutar auditorÃ­a Lighthouse y comparar con original
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `web-analyzer`**

      BUSCAR MCP LIGHTHOUSE:
      - Ejecutar: search_tools("lighthouse")
      - Usar: execute_mcp_tool("lighthouse", "run_audit", {url: "http://localhost:8000"})

      PREREQUISITO: Servidor corriendo (deno task build && deno task start)

      COMPARAR:
      | MÃ©trica        | Original | Nueva | Target | Â¿OK? |
      |----------------|----------|-------|--------|------|
      | Performance    |    ??    |  ??   |  >90   |      |
      | Accessibility  |    ??    |  ??   |  >95   |      |
      | Best Practices |    ??    |  ??   |  >95   |      |
      | SEO            |    ??    |  ??   |  >95   |      |

      SEÃ‘ALES:
      - Si TODOS â‰¥ target â†’ "auditorÃ­a aprobada"
      - Si alguno falla â†’ "requiere correcciones"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: "lighthouse-fixes"
    name: "Correcciones Lighthouse"
    model: sonnet
    max_visits: 20
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: Resolver issues de Lighthouse para alcanzar targets
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `orchestrator`**

      El subagente debe usar sequential-thinking para analizar y corregir.

      CORREGIR POR CATEGORÃA:

      PERFORMANCE:
      â–¡ Optimizar imÃ¡genes (WebP, lazy loading)
      â–¡ Preload recursos crÃ­ticos

      ACCESSIBILITY:
      â–¡ Corregir contraste
      â–¡ AÃ±adir labels faltantes

      BEST PRACTICES:
      â–¡ Sin errores consola
      â–¡ Images con aspect ratio

      SEO:
      â–¡ Meta tags faltantes
      â–¡ Alt text

      DESPUÃ‰S: deno task build && deno task start

      SEÃ‘AL DE COMPLETADO: "correcciones aplicadas"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  # ---------------------------------------------------------------------------
  # FASE 8: REVIEW FINAL
  # ---------------------------------------------------------------------------

  - id: "final-review"
    name: "Review Final"
    model: opus
    max_visits: 5
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      TAREA: ValidaciÃ³n final completa del proyecto
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `orchestrator`**

      El subagente debe usar sequential-thinking para review final.

      CHECKLIST:
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ LIGHTHOUSE: Performance â‰¥90, Accessibility â‰¥95, BP â‰¥95, SEO â‰¥95        â”‚
      â”‚ SEO: sitemap.xml, robots.txt, Schema.org, Open Graph                   â”‚
      â”‚ UI/UX: Review aprobado, responsive, imÃ¡genes de calidad                â”‚
      â”‚ LEGAL: Privacidad, Cookie consent                                      â”‚
      â”‚ ERROR PAGES: 404, 500 personalizadas                                   â”‚
      â”‚ CONTENIDO: Precios correctos, nombres exactos, acentuaciÃ³n             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      SEÃ‘ALES:
      - Si TODO ok â†’ "review aprobado"
      - Si falta algo â†’ "requiere mÃ¡s trabajo"
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  - id: "deployment-ready"
    name: "Listo para Deploy"
    is_end: true
    model: haiku
    max_visits: 1
    prompt_injection: |
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      PROYECTO COMPLETADO - RESUMEN FINAL
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      **OBLIGATORIO: Delega esta tarea al subagente `fresh-developer`**

      GENERAR RESUMEN:
      1. URL Original analizada
      2. Proyecto creado en [ruta]
      3. Secciones implementadas
      4. Islands aÃ±adidos
      5. ImÃ¡genes Pexels (con crÃ©ditos)

      COMPARACIÃ“N LIGHTHOUSE:
      | MÃ©trica | Original | Final | Mejora |

      VERIFICACIÃ“N DE CONTENIDO:
      â–¡ Precios en moneda correcta
      â–¡ Nombres de productos exactos
      â–¡ AcentuaciÃ³n correcta

      COMANDOS PARA EJECUTAR:
      cd [ruta]
      deno task build && deno task start
      â†’ http://localhost:8000

      DEPLOY: Deno Deploy (https://dash.deno.com)
      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# =============================================================================
# EDGES - Transiciones optimizadas
# =============================================================================

edges:
  # --- Fase 1: Captura y AnÃ¡lisis ---
  - id: "capture-to-analysis"
    from: "url-capture"
    to: "web-analysis"
    condition:
      type: "phrase"
      phrases:
        - "url capturada"
    priority: 1

  - id: "analysis-to-planning"
    from: "web-analysis"
    to: "strategic-planning"
    condition:
      type: "phrase"
      phrases:
        - "anÃ¡lisis completado"
    priority: 1

  # --- Fase 2: PlanificaciÃ³n ---
  - id: "planning-to-build"
    from: "strategic-planning"
    to: "project-build"
    condition:
      type: "phrase"
      phrases:
        - "sÃ­ntesis completada"
    priority: 1

  # --- Fase 3: ConstrucciÃ³n (FUSIONADO) ---
  - id: "build-to-creative"
    from: "project-build"
    to: "creative-direction"
    condition:
      type: "phrase"
      phrases:
        - "proyecto construido"
    priority: 1

  # --- Fase 4: DirecciÃ³n Creativa ---
  - id: "creative-to-ui-review"
    from: "creative-direction"
    to: "ui-review"
    condition:
      type: "phrase"
      phrases:
        - "direcciÃ³n creativa aplicada"
    priority: 1

  # --- Fase 5: UI Review (LOOP) ---
  - id: "ui-review-to-fixes"
    from: "ui-review"
    to: "ui-fixes"
    condition:
      type: "phrase"
      phrases:
        - "ui requiere mejoras"
    priority: 1

  - id: "ui-fixes-to-review"
    from: "ui-fixes"
    to: "ui-review"
    condition:
      type: "phrase"
      phrases:
        - "correcciones ui aplicadas"
    priority: 1

  - id: "ui-review-to-seo"
    from: "ui-review"
    to: "seo-technical"
    condition:
      type: "phrase"
      phrases:
        - "ui review aprobado"
    priority: 2

  # --- Fase 6: SEO y TÃ©cnicos (FUSIONADO) ---
  - id: "seo-to-audit"
    from: "seo-technical"
    to: "lighthouse-audit"
    condition:
      type: "phrase"
      phrases:
        - "seo y tÃ©cnicos listos"
    priority: 1

  # --- Fase 7: AuditorÃ­a (LOOP) ---
  - id: "audit-to-fixes"
    from: "lighthouse-audit"
    to: "lighthouse-fixes"
    condition:
      type: "phrase"
      phrases:
        - "requiere correcciones"
    priority: 1

  - id: "fixes-to-audit"
    from: "lighthouse-fixes"
    to: "lighthouse-audit"
    condition:
      type: "phrase"
      phrases:
        - "correcciones aplicadas"
    priority: 1

  - id: "audit-to-review"
    from: "lighthouse-audit"
    to: "final-review"
    condition:
      type: "phrase"
      phrases:
        - "auditorÃ­a aprobada"
    priority: 2

  # --- Fase 8: Final ---
  - id: "review-to-fixes"
    from: "final-review"
    to: "lighthouse-fixes"
    condition:
      type: "phrase"
      phrases:
        - "requiere mÃ¡s trabajo"
    priority: 1

  - id: "review-to-complete"
    from: "final-review"
    to: "deployment-ready"
    condition:
      type: "phrase"
      phrases:
        - "review aprobado"
    priority: 2
